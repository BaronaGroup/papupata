(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{481:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(435),i=n(129),s=n(436),r=n(496),l=n(434),u=n(48),c=n(0);t.default=function(){return Object(c.d)(s.a,null,Object(c.d)(o.a,null,Object(c.d)(i.a,null,Object(c.d)("h1",null,"Guide: calling APIs"),Object(c.d)(r.c,null,"When you are using someone else's API, this is where the magic happens for you. Making API requests may never have been this simple without a fully featured support library."),Object(c.d)(r.b,{content:[{heading:"Prerequisites",anchor:"prerequisites",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"Before starting this guide, you need to have an API declaration, with declared APIs. For information on how to get there, see ",Object(c.d)(u.a,{to:"/guides/declaring"},"Declaring APIs"),". You also need to have configured the API declaration to be able to make requests. This is covered in ",Object(c.d)(u.a,{to:"/guides/client/setup"},"Setting up papupata")),Object(c.d)("p",null,"For the examples in the guide, the following code is assumed to be present in the scope, and by this time you should be fully aware of what it all means:"),Object(c.d)(l.c,null,"\n                    const API = new APIDeclaration()\n                    const api = API.declarePatchAPI('/update/:id')\n                      .params(['id'] as const)\n                      .body<{name: string}>()\n                      .response<string>()\n                  "))},{heading:"The Basics",anchor:"basics",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"With properly set up papupata the some complexities of dealing with REST APIs are hidden well under the hood. You have a function, with typed arguments helping you avoid mistakes."),Object(c.d)("p",null,"Now, if you looked at the API we will be using, you probably noticed that thare are two parameters to the API. A path parameter, id, and a body that is an object with name in it."),Object(c.d)("p",null,"Now let's call the API:"),Object(c.d)(l.c,null,"\n                    await api({ id: 'alpha', name: 'Kevin'})\n                  "),Object(c.d)("p",null,"That's all there is to it. You never had to know the actual URL. As you can see, all parameters go into the same object regardless of where they are meant to end up. Body, query and path parameters, all in one. This does mean that you cannot have different parameters with the same name in different places, but in most cases that sounds like a bad idea to begin with."),Object(c.d)("p",null,"Things work as you would expect: optional parameters are optional, boolean parameters accept booleans and so on. With a properly declared API you can even pass in dates even though they'll probably becomes strings as they are converted to JSON. It is fully typed as well, so typescript will complain if you try to do something that contradicts the declaration."),Object(c.d)("p",null,"You can of course receive responses from the API. You probably guessed it already, but the promise returned by the call resolves to that value. The response too, of course, is fully typed."),Object(c.d)(l.c,null,"\n                    const response = await api({ id: 'alpha', name: 'Kevin'})\n                    // the response from the api is now in response. Typescript knows it's a string, as that's\n                    // how it was declared to be.\n                  "))},{heading:"Non-object bodies",anchor:"bodies",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"All in one object sounds like a good idea until it is not. What if you are not passing an object? Even things as mundane as arrays and strings won't work in that case."),Object(c.d)("p",null,"This is something papupata is prepared for. Instead of passing everything as a single parameter, you can pass the body as the first parameter with path and query parameters in another."),Object(c.d)(l.c,null,"\n                  await api({name: 'Kevin'}, {id: 'alpha'})\n                "),Object(c.d)("p",null,"Sometimes you might want to do this for the sake of clarity as well."))},{heading:"Options",anchor:"options",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"It is possible to pass options to the code that actually performs the HTTP request for papupata. They are given as an additional final parameter to the API call, whether or not you gave the body as a separate parameter."),Object(c.d)("p",null,"The build in adapters do not support options, see"," ",Object(c.d)(u.a,{to:"/guides/client/customRequestAdapters"},"custom request adapters")," for more information on how to utilize the options."),Object(c.d)(l.c,null,"\n                  await api({name: 'Kevin'}, {id: 'alpha'}, {options: 123})\n                  await api({name: 'Kevin', id: 'alpha'}, {options: 123})\n                  "))},{heading:"Bypassing papupata",anchor:"bypassing",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"Sometimes an API can be difficult to call using papupata. A common example would be piping a stream to a request, this is not something papupata can handle at this time. Sometimes you just want to call an API an unconventional fashion, bypassing all of papupata's logic."),Object(c.d)("p",null,"Even in these case you can still take advantage of the API declarations set up for papupata. You can use the"," ",Object(c.d)(r.a,null,"getURL")," method on an API to get the URL for an API, with its path and possibly query parameters set up."),Object(c.d)("p",null,"If you want to create an object that matches the declared body, you can get the type of"," ",Object(c.d)(r.a,null,"RequestBody")," for the API, and similarly use ",Object(c.d)(r.a,null,"ResponseType")," for the response."),Object(c.d)(l.c,null,"\n                    const body: typeof api.BodyType = { name: 'Kevin' }\n                    const url = api.getURL({id: 'alpha'})\n                    const response: typeof api.ResponseType = await myInvoke(url, body)\n                  "))},{heading:"Conclusion",anchor:"conclusion",content:Object(c.d)(a.Fragment,null,Object(c.d)("p",null,"Now you know how to call APIs. You might want to know more about how to write tests for client code that utilizes papupata. For that, see ",Object(c.d)(u.a,{to:"/guides/client/testing"},"testing"),"."),Object(c.d)("p",null,"If you want to switch to the server side now,",Object(c.d)(u.a,{to:"/guides/server/setup"},"setting up papupata server")," and"," ",Object(c.d)(u.a,{to:"/guides/server/implementing"},"implementing APIs")," are both fine options."))}]}))))}},496:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return b}));n(497),n(1);var a=n(434),o=n(4),i=n(0);function s(){var e=u(['\n  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace\n']);return s=function(){return e},e}function r(){var e=u(["\n  font-size: 1.1em;\n"]);return r=function(){return e},e}function l(){var e=u([""]);return l=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),e.raw=t,e}function c(e){var t=e.children;return Object(i.d)(a.j,null,Object(i.d)(a.k,null,"Overview"),t)}var d=o.a.h4(l()),p=o.a.h5(r());function h(e){var t=e.content;return Object(i.d)("div",null,Object(i.d)(a.j,null,Object(i.d)(a.k,null,"Table of contents"),Object(i.d)("ul",null,t.map((function(e){return Object(i.d)("li",{style:{marginLeft:18*(e.level||0)},key:e.anchor},Object(i.d)("a",{href:"#"+e.anchor},e.heading))})))),t.map((function(e){var t=e.level?p:d;return Object(i.d)(a.j,{id:e.anchor,key:e.anchor},Object(i.d)(t,null,e.heading),e.content)})))}var b=o.a.span(s())},497:function(e,t,n){"use strict";n(102)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))}}]);
//# sourceMappingURL=component---src-pages-guides-client-calling-tsx-cbf3782542cab2a21c77.js.map