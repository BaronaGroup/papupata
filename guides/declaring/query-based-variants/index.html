<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/papupata/styles.72f89f3faef242b2669e.css" id="gatsby-global-css">/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */*,:after,:before{box-sizing:border-box}html{-webkit-text-size-adjust:100%;line-height:1.15;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;margin:0}hr{color:inherit;height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}</style><meta name="generator" content="Gatsby 3.6.2"/><link rel="canonical" href="https://gatsby-starter-typescript-plus.netlify.com/guides/declaring/query-based-variants/" data-baseprotocol="https:" data-basehost="gatsby-starter-typescript-plus.netlify.com"/><title data-react-helmet="true">Papupata Documentation</title><meta data-react-helmet="true" name="description" content="Documentation for the typescript library papupata, for utilizing types for AJAX requests."/><meta data-react-helmet="true" name="keywords"/><link as="script" rel="preload" href="/papupata/webpack-runtime-79a290cdc6bc41719466.js"/><link as="script" rel="preload" href="/papupata/framework-dc80b13bf39831b3d433.js"/><link as="script" rel="preload" href="/papupata/app-1d46734f896b90de6294.js"/><link as="script" rel="preload" href="/papupata/commons-66d32ce1d5d13085e163.js"/><link as="script" rel="preload" href="/papupata/8bd8962e0d246101d5fe70c9e6bee35d3a158374-6f38b19a63daf7d86dab.js"/><link as="script" rel="preload" href="/papupata/component---src-pages-guides-declaring-query-based-variants-tsx-d341c3e7b2793c80b8c6.js"/><link as="fetch" rel="preload" href="/papupata/page-data/guides/declaring/query-based-variants/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/papupata/page-data/sq/d/1963140206.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/papupata/page-data/sq/d/2219842477.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/papupata/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global 1sdnwx3">html{box-sizing:border-box;}*,*::before,*::after{box-sizing:inherit;}html{font-size:16px!important;line-height:1.45!important;}body{width:100%;overflow-x:hidden;overflow-y:scroll;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif;color:#000;background-color:#fff;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;}a{color:#663399;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:focus{-webkit-text-decoration:underline;text-decoration:underline;}img{max-width:100%;object-fit:contain;position:relative;}figure{margin:2rem 0;}figcaption{font-size:80%;}table{width:100%;margin-bottom:1rem;border:1px solid #f5f3f7;font-size:85%;border-collapse:collapse;}td,th{padding:.25rem .5rem;border:1px solid #f5f3f7;}th{text-align:left;}tbody tr:nth-of-type(odd) td{background-color:#fbfafc;}tbody tr:nth-of-type(odd) tr{background-color:#fbfafc;}h1,h2,h3,h4,h5,h6{margin-top:1.414rem;margin-bottom:.5rem;color:#000;font-weight:600;line-height:1.2;text-rendering:optimizeLegibility;}h1{margin-top:0;font-size:2.441rem;}h2{font-size:1.953rem;}h3{font-size:1.563rem;}h4,h5,h6{font-size:1.25rem;}p{margin-top:0;margin-bottom:1rem;}strong{color:#000;}ul,ol,dl{margin-top:0;margin-bottom:1rem;}dt{font-weight:bold;}dd{margin-bottom:.5rem;}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid #f5f3f7;}blockquote{margin:.8rem 0;padding:.5rem 1rem;border-left:.25rem solid #f5f3f7;color:rgba(0, 0, 0, 0.54);}blockquote p:last-child{margin-bottom:0;}@media (min-width: 48em){blockquote{padding-right:5rem;padding-left:1.25rem;}}</style><style data-emotion="css 11pfcjj">.css-11pfcjj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><div class="css-11pfcjj e1qi6hgo0"><style data-emotion="css 1atnuaa">.css-1atnuaa{height:60px;padding:0 1.5rem;background-color:#663399;color:rgba(255,255,255,0.5);}</style><header class="css-1atnuaa ew8ynk82"><style data-emotion="css 1tev41e">.css-1tev41e{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}</style><style data-emotion="css 8gr2bf">.css-8gr2bf{position:relative;margin-left:auto;margin-right:auto;width:auto;max-width:60em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}</style><div class="ew8ynk81 css-8gr2bf euf2zmc0"><style data-emotion="css 1u0571z">.css-1u0571z{color:#fff;font-size:1.5rem;font-weight:600;}.css-1u0571z:hover,.css-1u0571z:focus{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-1u0571z ew8ynk80" href="/papupata/">Papupata Documentation</a></div></header><div class="sc-iqAclL jibPFy"><div class="sc-iCoGMd kMthTr"><h2 class="sc-fujyAs eysHZq">Table of contents</h2><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/what-is-papupata">What is papupata?</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/getting-started">Getting started</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/concepts">Concepts and terms</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides">Guides</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/declaring">Declaring APIs</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/declaring">Basics</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/declaring/typeMapping">Types for path and query</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/declaring/query-based-variants">Query-based variants</a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/metadata">Accessing metadata</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/sharing">Sharing APIs declarations</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides?client">Clients</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/client/setup">Setting up papupata</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/client/calling">Calling APIs</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/client/customRequestAdapters">Custom request adapters</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/client/testing">Testing</a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides?server">Servers</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/server/setup">Setting up papupata</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/server/implementing">Implementing APIs</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/server/interactingWithExpress">Interacting with express</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/server/middleware">Middleware</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/server/testing">Testing</a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/guides/migrationToV2">Migrating to papupata 2.x</a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api-reference">API Reference</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration">class APIDeclaration</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/configure"><span>configure<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/declareDeleteAPI"><span>declareDeleteAPI<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/declareGetAPI"><span>declareGetAPI<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/declarePostAPI"><span>declarePostAPI<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/declarePatchAPI"><span>declarePatchAPI<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/declarePutAPI"><span>declarePutAPI<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/getConfig"><span>getConfig<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/unmockAll"><span>unmockAll<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/APIDeclaration/updateConfig"><span>updateConfig<!-- -->()</span></a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI">PartiallyDeclaredAPI</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/params"><span>params<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/query"><span>query<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/optionalQuery"><span>optionalQuery<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/queryBool"><span><span class="sc-jrsJWt dJdFwe">queryBool</span>()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/body"><span>body<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/response"><span>response<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/PartiallyDeclaredAPI/TypeMapping"><span class="sc-pNWdM XJxhY">TypeMapping</span></a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI">DeclaredAPI</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/invoke"><span>invoke<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/getURL"><span>getURL<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implement"><span>implement<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implementation"><span class="sc-kEqXSa bAVzgZ">implementation</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implementationMiddleware"><span class="sc-kEqXSa bAVzgZ">implementationMiddleware</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implementWithMiddleware"><span>implementWithMiddleware<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implementWithExpressMiddleware"><span>implementWithExpressMiddleware<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/implementWithPapupataMiddleware"><span>implementWithPapupataMiddleware<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/mock"><span>mock<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/mockOnce"><span>mockOnce<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/unmock"><span>unmock<!-- -->()</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/method"><span class="sc-kEqXSa bAVzgZ">method</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/apiDeclaration"><span class="sc-kEqXSa bAVzgZ">apiDeclaration</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/apiUrlParameters"><span class="sc-kEqXSa bAVzgZ">apiUrlParameters</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/path"><span class="sc-kEqXSa bAVzgZ">path</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/ResponseType"><span class="sc-pNWdM XJxhY">ResponseType</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/ServerResponseType"><span class="sc-pNWdM XJxhY">ServerResponseType</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/BodyType"><span class="sc-pNWdM XJxhY">BodyType</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/CallArgsType"><span class="sc-pNWdM XJxhY">CallArgsType</span></a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/DeclaredAPI/RequestType"><span class="sc-pNWdM XJxhY">RequestType</span></a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/convertExpressMiddleware">convertExpressMiddleware</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/skipHandlingRoute">skipHandlingRoute</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/handleUndefinedResponsesMiddleware">handleUndefinedResponsesMiddleware</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/fetchAdapter">fetchAdapter</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/requestPromiseAdapter">requestPromiseAdapter</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/supertestAdapter">supertestAdapter</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/supertestInvoker">supertestInvoker</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/invokeImplementationAdapter">invokeImplementationAdapter</a></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/api/testInvoker">testInvoker</a></div></label></div></label><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><span class="sc-eCApnc iylGhi">&gt;</span><a current="false" class="sc-gtsrHT juhBur" href="/papupata/experimental">Experimental</a></div><div class="sc-hKFxyN kksiKu"><label class="sc-gKAaRy hydYaP"><input type="checkbox" readonly="" class="sc-jSFjdj jcTaHb"/><div class="sc-bdnxRM jvCTkj"><a current="false" class="sc-gtsrHT juhBur" href="/papupata/experimental/papupata-from-openapi">Conversion from OpenAPI</a></div></label></div></label></div><style data-emotion="css 1wmy9hl">.css-1wmy9hl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1;-ms-flex:1;flex:1;}</style><main class="css-1wmy9hl e1mc0fse0"><style data-emotion="css pcbh56">.css-pcbh56{display:block;-webkit-flex:1;-ms-flex:1;flex:1;position:relative;padding:1.5rem;margin-bottom:3rem;}</style><div class="css-pcbh56 e1cg1sy10"><style data-emotion="css fkj7ih">.css-fkj7ih{position:relative;margin-left:auto;margin-right:auto;width:auto;max-width:60em;}</style><div class="css-fkj7ih euf2zmc0"><h1>Guide: Query-based variants</h1><section class="sc-dIsUp jEEywD"><h4 class="sc-bqGGPW iPexDg">Overview</h4>Sometimes you have APIs that only differ from each other based on their query parameters. For example, the response could be of a different type based on value of one. Papupata offers a way to deal with this.</section><section class="sc-dIsUp jEEywD"><h4 class="sc-bqGGPW iPexDg">Availability</h4>This functionality is available from papupata version <!-- -->1.8.0<!-- --> onwards.</section><div><section class="sc-dIsUp jEEywD"><h4 class="sc-bqGGPW iPexDg">Table of contents</h4><ul><li style="margin-left:0"><a href="#prerequisites">Prerequisites</a></li><li style="margin-left:0"><a href="#basics">The Basics</a></li><li style="margin-left:0"><a href="#specifics">The Specifics</a></li><li style="margin-left:36px"><a href="#hardcoded">Specific (hard-coded) values</a></li><li style="margin-left:36px"><a href="#non-matching">Non-matching value</a></li><li style="margin-left:36px"><a href="#lacking">Lack of query parameter</a></li><li style="margin-left:36px"><a href="#presence">Presence of query parameter</a></li><li style="margin-left:0"><a href="#ambiguous">Ambiguous calls</a></li><li style="margin-left:0"><a href="#gotcha">The big gotcha</a></li><li style="margin-left:0"><a href="#useCases">Use cases</a></li></ul></section><section id="prerequisites" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">Prerequisites</h4><p>Before starting this guide, you need to have an API declaration, with declared APIs. For information on how to get there, see <a href="/papupata/guides/declaring">Declaring APIs</a>.</p><p>For the examples in the guide, the following code is assumed to be present in the scope:</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">import</span><span> { APIDeclaration } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;papupata&#x27;</span><span>
</span><span></span><span style="color:#954121">const</span><span> API = </span><span style="color:#954121">new</span><span> APIDeclaration()</span></code></pre></div></section><section id="basics" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">The Basics</h4><p>Query parameter based API selection is embedded into the path portion of an API declaration. This is because it, like everything else in the path, affects the routing that connects the request to the correct handler.</p><p>The query parameter routing information is presented in a fashion not unlike regular query parameters, but there are extensions to the syntax.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant=orange&#x27;</span><span>).response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div><p>There can be any number of query parameter based constraints on an API, even multiple ones for the same parameter when it makes sense.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant=orange&amp;travel=underwater&amp;liquid=water&#x27;</span><span>).response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></section><section id="specifics" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">The Specifics</h4></section><section id="hardcoded" class="sc-dIsUp jEEywD"><h5 class="sc-iklJeh hbusih">Specific (hard-coded) values</h5><p>Requiring a query parameter to have a specific value is done with the regular query string syntax, such as</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant=orange&#x27;</span><span>).response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div><p>requires all invocations of the API to have the query parameter <span class="sc-jJMGnK laKGqb">variant</span> set to<!-- --> <span class="sc-jJMGnK laKGqb">orange</span>. When using papupata to call the API, it automatically sets up the variable, and in fact you generally speaking cannot set it manually. That is, making the call:</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">await</span><span> api()</span></code></pre></div><p>You are not expected to include <span class="sc-jJMGnK laKGqb">{variant: &#x27;orange&#x27;}</span> in the call, although it will be included in the actual REST call.</p><p>On the server, according to type information that parameter is not available, but it is in fact there in case, say, a middleware needs access to it. If you <strong>really</strong> need it in the types, you can add the parameter into the<!-- --> <span class="sc-jJMGnK laKGqb">optionalQuery</span> portion of the declaration, even though it is not actually optional. This is done to ensure that the invocation does not require the user to enter it.</p><p>You can have multiple possible values for the parameter. Of course the parameter cannot be all of them at once (as arrays are not supported), so this just means that any of the values will do. Note that this creates an<!-- --> <a href="#ambiguous">ambiguous call</a>.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant=orange&amp;variant=red&amp;variant=yellow&#x27;</span><span>).response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></section><section id="non-matching" class="sc-dIsUp jEEywD"><h5 class="sc-iklJeh hbusih">Non-matching value</h5><p>You can have an API that only applies when a parameter has a value that is not one of the ones you&#x27;ve specified. Instead of the usual name=value notation, you instead use value!=value.</p><div class="sc-giAqHp bYgUJS"><select><option value="1.x">Papupata 1.x</option><option selected="" value="2.x">Papupata 2.x</option></select><div class="sc-ezzafa dvHFX">Older styles are still supported in later versions, just not preferred.</div><div><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant!=orange&#x27;</span><span>)
</span><span>  .query({</span><span class="hljs-attr">variant</span><span>: </span><span style="color:#0086b3">String</span><span>})
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></div></div><p>requires all invocations of the API to have the query parameter <span class="sc-jJMGnK laKGqb">variant</span> not to be set to<!-- --> <span class="sc-jJMGnK laKGqb">orange</span></p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">await</span><span> api({</span><span class="hljs-attr">variant</span><span>: </span><span style="color:#219161">&#x27;purple&#x27;</span><span>})</span></code></pre></div><p>If you attempt to supply one of the forbidden values for a client invocation, it will throw an exception. On the server, this is just a regular query parameter.</p><p>Do note that the lack of a value is considered to pass this check, so the following is fine as well:</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant!=orange&#x27;</span><span>).response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()
</span><span></span><span style="color:#954121">await</span><span> api()</span></code></pre></div><p>While it is a bit odd, this way the non-matching value is the exact opposite of the specific value routing, covering all cases. If you specifically want there to be a value which is not one of the ones you&#x27;ve provided, you can combine this with &quot;any value&quot; routing rule.</p> <div class="sc-giAqHp bYgUJS"><select><option value="1.x">Papupata 1.x</option><option selected="" value="2.x">Papupata 2.x</option></select><div class="sc-ezzafa dvHFX">Older styles are still supported in later versions, just not preferred.</div><div><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant!=orange&amp;variant&#x27;</span><span>)
</span><span>  .query({</span><span class="hljs-attr">variant</span><span>: </span><span style="color:#0086b3">String</span><span>})
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></div></div></section><section id="lacking" class="sc-dIsUp jEEywD"><h5 class="sc-iklJeh hbusih">Lack of query parameter</h5><p>You can indicate that the API variant is only to be called when a query parameter is not present by prepending an exclamation mark to the name of the parameter.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?!variant&#x27;</span><span>)
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div><p>Do note that an empty value (calling the REST API with something like <span class="sc-jJMGnK laKGqb">/myAPI?variant=</span> or<!-- --> <span class="sc-jJMGnK laKGqb">/myAPI?variant</span>) <strong>is</strong> considered to be a call with the parameter present, and as such will not match the API as declared. You can declare an API that accepts both by combining it with specific value routing.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?!variant&amp;variant=&#x27;</span><span>)
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div><p>This creates an <a href="#ambiguous">ambiguous call</a>.</p></section><section id="presence" class="sc-dIsUp jEEywD"><h5 class="sc-iklJeh hbusih">Presence of query parameter</h5><p>You can indicate that the API variant is only to be called when a query parameter is present by simply having its name, with no equality or value in the query string part.</p> <div class="sc-giAqHp bYgUJS"><select><option value="1.x">Papupata 1.x</option><option selected="" value="2.x">Papupata 2.x</option></select><div class="sc-ezzafa dvHFX">Older styles are still supported in later versions, just not preferred.</div><div><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant&#x27;</span><span>)
</span><span>  .query({</span><span class="hljs-attr">variant</span><span>: </span><span style="color:#0086b3">String</span><span>})
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></div></div><p>Do note that an empty value (calling the REST API with something like <span class="sc-jJMGnK laKGqb">/myAPI?variant=</span> or<!-- --> <span class="sc-jJMGnK laKGqb">/myAPI?variant</span>) <strong>is</strong> considered to be a call with the parameter present and is match for this rule. You can specifically exclude empty values by using the non-matching value routing as well.</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> api = API.declareGetAPI(</span><span style="color:#219161">&#x27;/myAPI?variant&amp;variant!=&#x27;</span><span>)
</span><span>  .response&lt;</span><span style="color:#0086b3">void</span><span>&gt;()</span></code></pre></div></section><section id="ambiguous" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">Ambiguous calls</h4><p>By combining routing rules you can end up in a situation where there are multiple possible values for a query parameter. In these cases, when invoking the API using papupata, the client is guaranteed to choose valid parameters, but it may choose any valid combination in a potentially unpredictable fashion.</p></section><section id="gotcha" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">The big gotcha</h4><p>Unless you really know what you&#x27;re doing, having overlapping API declarations is a good way to cause issues for yourself down the line. That is, overlapping in the sense that as far as routing is concerned, multiple APIs could be valid for a single call.</p><p>To avoid doing this when using query-based API variants, instead of going with a default &quot;anything not handled goes here&quot; route, ensure your APIs use negations of the rules of the other routes to allow non-ambiguous routing.</p><p>A few examples:</p><div class="sc-cBoqAE lRfdj"><p>Specific value and non-specific value</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant=alpha&#x27;</span><span>)
</span><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant!=alpha&#x27;</span><span>)</span></code></pre></div></div><div class="sc-cBoqAE lRfdj"><p>Multiple specific values</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant=alpha&#x27;</span><span>)
</span><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant=beta&#x27;</span><span>)
</span><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant!=alpha&amp;variant!=beta&#x27;</span><span>)</span></code></pre></div></div><div class="sc-cBoqAE lRfdj"><p>Presence and non-presence</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant&#x27;</span><span>)
</span><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?!variant&#x27;</span><span>)</span></code></pre></div></div><div class="sc-cBoqAE lRfdj"><p>Presence of non-empty and non-present/empty</p><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?variant&amp;variant!=&#x27;</span><span>)
</span><span>API.declareGetAPI(</span><span style="color:#219161">&#x27;/api?!variant&amp;variant=&#x27;</span><span>)</span></code></pre></div></div><p>If this seems impractical because of, say, complexity, you can have overlap as long as you consider its implications, specifically how routing considers routes:</p><ul><li>if <span class="sc-jJMGnK laKGqb">autoImplementAllAPIs</span> is set to false (default in papupata 1.x), the variants are checked in their implementation order</li><li>if <span class="sc-jJMGnK laKGqb">autoImplementAllAPIs</span> is set to true (default in papupata 2.x), the variants are checked in their declaration order</li><li>If you encounter misrouting (whether in the route implementation or a middleware leading there), you can import<!-- --> <span class="sc-jJMGnK laKGqb">skipHandlingRoute</span>from papupata and return it to resume routing from later variants.</li></ul></section><section id="useCases" class="sc-dIsUp jEEywD"><h4 class="sc-kLojOw iehvjW">Use cases</h4><p>Probably the most likely use case are APIs that either accept differents sets of parameters based on other parameters, or ones that return different data based on the query parameters.</p><p>So let&#x27;s have an example of an API with different sets of inputs:</p><div class="sc-cBoqAE lRfdj"> <div class="sc-giAqHp bYgUJS"><select><option value="1.x">Papupata 1.x</option><option selected="" value="2.x">Papupata 2.x</option></select><div class="sc-ezzafa dvHFX">Older styles are still supported in later versions, just not preferred.</div><div><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> simpleSearch = API.declarePostAPI(</span><span style="color:#219161">&#x27;/search?advanced!=true&#x27;</span><span>)
</span><span>  .query({</span><span class="hljs-attr">queryString</span><span>: </span><span style="color:#0086b3">String</span><span>})
</span><span>  .response&lt;</span><span style="color:#0086b3">any</span><span>&gt;()
</span>
<span></span><span style="color:#954121">const</span><span> advancedSearch = API.declarePostAPI(</span><span style="color:#219161">&#x27;/search?advanced=true&#x27;</span><span>)
</span><span>  .query({</span><span class="hljs-attr">name</span><span>: </span><span style="color:#0086b3">String</span><span>, </span><span class="hljs-attr">address</span><span>: </span><span style="color:#0086b3">String</span><span>, </span><span class="hljs-attr">phone</span><span>: </span><span style="color:#0086b3">String</span><span>, </span><span class="hljs-attr">email</span><span>: </span><span style="color:#0086b3">String</span><span>}})
</span><span>  .response&lt;</span><span style="color:#0086b3">any</span><span>&gt;()</span></code></pre></div></div></div><p>So basically a single endpoint serves two types of search functionality, but using the query-based API variants we can have both of them work perfectly in a typed fashion.</p></div><p>And for different responses, perhaps something like this:</p><div class="sc-cBoqAE lRfdj"><div class="sc-crzoAE DykGo"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">const</span><span> myDetailsAPI = API.declarePostAPI(</span><span style="color:#219161">&#x27;/my-details?includeRelations=false&#x27;</span><span>)
</span>  .response&lt;UserDetails&gt;()
<!-- -->
<span></span><span style="color:#954121">const</span><span> myDetailsWithRelationsAPI = API.declarePostAPI(</span><span style="color:#219161">&#x27;/my-details?includeRelations=true&#x27;</span><span>)
</span>  .response&lt;UserDetails &amp; RelationInfo&gt;()
</code></pre></div><p>Again, a single API and two types of output, fully typed.</p></div></section></div></div></div></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/guides/declaring/query-based-variants/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-5338e31e9a7b3dbf697d.js"],"app":["/app-1d46734f896b90de6294.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-fcb916b4f0e28676627e.js"],"component---src-pages-api-api-declaration-configure-tsx":[],"component---src-pages-api-api-declaration-declare-delete-api-tsx":["/component---src-pages-api-api-declaration-declare-delete-api-tsx-f2bdc5315904602baa72.js"],"component---src-pages-api-api-declaration-declare-get-api-tsx":["/component---src-pages-api-api-declaration-declare-get-api-tsx-fcc45e3f26603d7a1d85.js"],"component---src-pages-api-api-declaration-declare-patch-api-tsx":["/component---src-pages-api-api-declaration-declare-patch-api-tsx-c37cfd703f4dae5c4626.js"],"component---src-pages-api-api-declaration-declare-post-api-tsx":["/component---src-pages-api-api-declaration-declare-post-api-tsx-02dc320974bf2fbd6386.js"],"component---src-pages-api-api-declaration-declare-put-api-tsx":["/component---src-pages-api-api-declaration-declare-put-api-tsx-5b6b2a0647b73ba5e611.js"],"component---src-pages-api-api-declaration-get-config-tsx":["/component---src-pages-api-api-declaration-get-config-tsx-5bc8dc8bbca292da01c1.js"],"component---src-pages-api-api-declaration-tsx":["/component---src-pages-api-api-declaration-tsx-a39fbdf78d704023a1f1.js"],"component---src-pages-api-api-declaration-unmock-all-tsx":["/component---src-pages-api-api-declaration-unmock-all-tsx-e2a331e0b1e56083a25f.js"],"component---src-pages-api-api-declaration-update-config-tsx":["/component---src-pages-api-api-declaration-update-config-tsx-04ce246a080e4f46c6e9.js"],"component---src-pages-api-convert-express-middleware-tsx":["/component---src-pages-api-convert-express-middleware-tsx-965f0d59a7f4875347f9.js"],"component---src-pages-api-declared-api-api-declaration-tsx":["/component---src-pages-api-declared-api-api-declaration-tsx-35f2f0db580627fc813a.js"],"component---src-pages-api-declared-api-api-url-parameters-tsx":["/component---src-pages-api-declared-api-api-url-parameters-tsx-b6349628527970eb7ad4.js"],"component---src-pages-api-declared-api-body-type-tsx":["/component---src-pages-api-declared-api-body-type-tsx-e7a00acd1184f8d9847b.js"],"component---src-pages-api-declared-api-call-args-type-tsx":["/component---src-pages-api-declared-api-call-args-type-tsx-091d839f3c3fb77a51ea.js"],"component---src-pages-api-declared-api-get-url-tsx":["/component---src-pages-api-declared-api-get-url-tsx-423d79c6b119ae12f979.js"],"component---src-pages-api-declared-api-implement-base-tsx":["/component---src-pages-api-declared-api-implement-base-tsx-9f8e1b394e5895f0dee8.js"],"component---src-pages-api-declared-api-implement-tsx":["/component---src-pages-api-declared-api-implement-tsx-3cc851c5310b396a158c.js"],"component---src-pages-api-declared-api-implement-with-express-middleware-tsx":["/component---src-pages-api-declared-api-implement-with-express-middleware-tsx-e78f3b40bb2809528007.js"],"component---src-pages-api-declared-api-implement-with-middleware-tsx":["/component---src-pages-api-declared-api-implement-with-middleware-tsx-22f2e44388f74b59ace6.js"],"component---src-pages-api-declared-api-implement-with-papupata-middleware-tsx":["/component---src-pages-api-declared-api-implement-with-papupata-middleware-tsx-a38c1c01723bf91c0f3b.js"],"component---src-pages-api-declared-api-implementation-middleware-tsx":["/component---src-pages-api-declared-api-implementation-middleware-tsx-54b6886b9c5562b7e80b.js"],"component---src-pages-api-declared-api-implementation-tsx":["/component---src-pages-api-declared-api-implementation-tsx-28a1343e7de112ba663e.js"],"component---src-pages-api-declared-api-invoke-tsx":["/component---src-pages-api-declared-api-invoke-tsx-bae0fde30830ec40435d.js"],"component---src-pages-api-declared-api-method-tsx":["/component---src-pages-api-declared-api-method-tsx-e7f3a6182698fcdf6c81.js"],"component---src-pages-api-declared-api-mock-once-tsx":["/component---src-pages-api-declared-api-mock-once-tsx-7ce078574556eff5f063.js"],"component---src-pages-api-declared-api-mock-tsx":["/component---src-pages-api-declared-api-mock-tsx-bf84f6848f543df16e87.js"],"component---src-pages-api-declared-api-path-tsx":["/component---src-pages-api-declared-api-path-tsx-110acea526c902b79e94.js"],"component---src-pages-api-declared-api-request-type-tsx":["/component---src-pages-api-declared-api-request-type-tsx-2fb34b7e4367f558b04d.js"],"component---src-pages-api-declared-api-response-type-tsx":["/component---src-pages-api-declared-api-response-type-tsx-213bcc65f28b039b72ff.js"],"component---src-pages-api-declared-api-server-response-type-tsx":["/component---src-pages-api-declared-api-server-response-type-tsx-86253726788dc65efa40.js"],"component---src-pages-api-declared-api-tsx":["/component---src-pages-api-declared-api-tsx-b7c4eef9b0f5c104804a.js"],"component---src-pages-api-declared-api-unmock-tsx":["/component---src-pages-api-declared-api-unmock-tsx-7725021fa84e7dd15eae.js"],"component---src-pages-api-fetch-adapter-tsx":["/component---src-pages-api-fetch-adapter-tsx-2d1939a56e1da4014f7f.js"],"component---src-pages-api-handle-undefined-responses-middleware-tsx":["/component---src-pages-api-handle-undefined-responses-middleware-tsx-b18827ed33000835692b.js"],"component---src-pages-api-invoke-implementation-adapter-tsx":["/component---src-pages-api-invoke-implementation-adapter-tsx-cf39d0b77de3a9c67376.js"],"component---src-pages-api-partially-declared-api-body-tsx":["/component---src-pages-api-partially-declared-api-body-tsx-a12da8c56ae8e6b7da2b.js"],"component---src-pages-api-partially-declared-api-optional-query-tsx":["/component---src-pages-api-partially-declared-api-optional-query-tsx-072abdb0c2661fdfa926.js"],"component---src-pages-api-partially-declared-api-params-tsx":["/component---src-pages-api-partially-declared-api-params-tsx-410ea206aeb8ef88d8ef.js"],"component---src-pages-api-partially-declared-api-query-bool-tsx":["/component---src-pages-api-partially-declared-api-query-bool-tsx-971f6f5ef04476e7f5c3.js"],"component---src-pages-api-partially-declared-api-query-tsx":["/component---src-pages-api-partially-declared-api-query-tsx-19074d3f67f23288141e.js"],"component---src-pages-api-partially-declared-api-response-tsx":["/component---src-pages-api-partially-declared-api-response-tsx-d4a796f8e602321ef27d.js"],"component---src-pages-api-partially-declared-api-tsx":["/component---src-pages-api-partially-declared-api-tsx-740935e3a9bcb0cd21c8.js"],"component---src-pages-api-partially-declared-api-type-mapping-tsx":["/component---src-pages-api-partially-declared-api-type-mapping-tsx-57e1387a9a85e6443c54.js"],"component---src-pages-api-request-promise-adapter-tsx":["/component---src-pages-api-request-promise-adapter-tsx-7d1ced307d06c05da791.js"],"component---src-pages-api-skip-handling-route-tsx":["/component---src-pages-api-skip-handling-route-tsx-5a9e61cc3a2fa1a75bdf.js"],"component---src-pages-api-supertest-adapter-tsx":["/component---src-pages-api-supertest-adapter-tsx-46bffdc49ac72964f0b3.js"],"component---src-pages-api-supertest-invoker-tsx":["/component---src-pages-api-supertest-invoker-tsx-f7fb5c2350c5819b0939.js"],"component---src-pages-api-test-invoker-tsx":["/component---src-pages-api-test-invoker-tsx-9709ddb02d4136a4ec5c.js"],"component---src-pages-concepts-tsx":["/component---src-pages-concepts-tsx-62e0f24f70c35ddf606f.js"],"component---src-pages-experimental-papupata-from-openapi-tsx":["/component---src-pages-experimental-papupata-from-openapi-tsx-1c6b97de4c02f70543cb.js"],"component---src-pages-experimental-tsx":["/component---src-pages-experimental-tsx-d6e3110d5957e619e195.js"],"component---src-pages-getting-started-tsx":["/component---src-pages-getting-started-tsx-527c7a29808c381ebf31.js"],"component---src-pages-guides-client-calling-tsx":["/component---src-pages-guides-client-calling-tsx-b23e2c8cd16aa9c9666a.js"],"component---src-pages-guides-client-custom-request-adapters-tsx":["/component---src-pages-guides-client-custom-request-adapters-tsx-a773ea31da8c6ff1db6b.js"],"component---src-pages-guides-client-setup-tsx":["/component---src-pages-guides-client-setup-tsx-87cdcdf47eb6e37e7656.js"],"component---src-pages-guides-client-testing-tsx":["/component---src-pages-guides-client-testing-tsx-33774feec554dca9a994.js"],"component---src-pages-guides-declaring-query-based-variants-tsx":["/component---src-pages-guides-declaring-query-based-variants-tsx-d341c3e7b2793c80b8c6.js"],"component---src-pages-guides-declaring-tsx":["/component---src-pages-guides-declaring-tsx-549a31a796e29f33ac6e.js"],"component---src-pages-guides-declaring-type-mapping-tsx":["/component---src-pages-guides-declaring-type-mapping-tsx-6154d7adb4b26902f5e6.js"],"component---src-pages-guides-metadata-tsx":["/component---src-pages-guides-metadata-tsx-9709dfb58dbc43b40748.js"],"component---src-pages-guides-migration-to-v-2-tsx":["/component---src-pages-guides-migration-to-v-2-tsx-41ea77d527ad47845afb.js"],"component---src-pages-guides-server-implementing-tsx":["/component---src-pages-guides-server-implementing-tsx-66e2b1c0a5dc16fbfd57.js"],"component---src-pages-guides-server-interacting-with-express-tsx":["/component---src-pages-guides-server-interacting-with-express-tsx-6317fabcf6f8e4e9470b.js"],"component---src-pages-guides-server-middleware-tsx":["/component---src-pages-guides-server-middleware-tsx-3f168a8be86469e5be61.js"],"component---src-pages-guides-server-setup-tsx":["/component---src-pages-guides-server-setup-tsx-8c52c1412b1703608573.js"],"component---src-pages-guides-server-testing-tsx":["/component---src-pages-guides-server-testing-tsx-ac5dc78cae4db3529443.js"],"component---src-pages-guides-sharing-tsx":["/component---src-pages-guides-sharing-tsx-27a4eee22f87b94897d7.js"],"component---src-pages-guides-tsx":["/component---src-pages-guides-tsx-50b42ec6ca1e07c39339.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-7027a32a53d1948d1cbd.js"],"component---src-pages-page-2-tsx":["/component---src-pages-page-2-tsx-cb87c40e5c81820300aa.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-e7dbfeb0d2c312ec94d1.js"]};/*]]>*/</script><script src="/papupata/polyfill-5338e31e9a7b3dbf697d.js" nomodule=""></script><script src="/papupata/component---src-pages-guides-declaring-query-based-variants-tsx-d341c3e7b2793c80b8c6.js" async=""></script><script src="/papupata/8bd8962e0d246101d5fe70c9e6bee35d3a158374-6f38b19a63daf7d86dab.js" async=""></script><script src="/papupata/commons-66d32ce1d5d13085e163.js" async=""></script><script src="/papupata/app-1d46734f896b90de6294.js" async=""></script><script src="/papupata/framework-dc80b13bf39831b3d433.js" async=""></script><script src="/papupata/webpack-runtime-79a290cdc6bc41719466.js" async=""></script></body></html>