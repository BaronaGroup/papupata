(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{493:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(435),r=n(130),s=n(436),l=n(504),i=n(434),c=n(4),p=n(0);function u(){var e=function(e,t){t||(t=e.slice(0));return e.raw=t,e}(["\n  border-left: 3px solid #eee;\n  padding-left: 30px;\n  margin-bottom: 30px;\n"]);return u=function(){return e},e}c.a.div(u());t.default=function(){return Object(p.d)(s.a,null,Object(p.d)(o.a,null,Object(p.d)(r.a,null,Object(p.d)("h1",null,"Guide: accessing metadata"),Object(p.d)(l.c,null,"Papupata allows you to declare, call and implement APIs. Sometimes you need to do something slightly different though and need access to information about the API. This guide helps you with that."),Object(p.d)(l.b,{content:[{heading:"To begin with",anchor:"setup",content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"It might be helpful fairly solid understanding of what papupata API declarations look like."),Object(p.d)("p",null,"In the examples presented in this guide, the following API declaration is assumed to be in the scope:"),Object(p.d)(i.c,null,"\n                  const complexAPI = API.declarePostAPI('/update/:id', routeOptions)\n                    .params(['id'] as const)\n                    .query(['author'] as const)\n                    .optionalQuery(['timestamp'] as const)\n                    .queryBool(['notifyWatchers'] as const)\n                    .body<{ name: string}>()\n                    .response<{status: string }>()\n                  "))},{heading:"URLs and methods",anchor:"endpoints",content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"The most basic things, path and method as specified when declared the API can be accessed directly from the api object."),Object(p.d)(i.c,null,"\n                  const {method, path} = complexAPI\n                  // method: post\n                  // path: /update/:id\n                "),Object(p.d)("p",null,"The path might not be quite what you need though. Perhaps you want a full URL, with path and possibly query parameters already in place. This can be done with the ",Object(p.d)(l.a,null,"getURL")," method. Do note that the method requires"," ",Object(p.d)(l.a,null,"baseURL")," to be configured."),Object(p.d)(i.c,null,"\n                    API.configure({\n                      ...api.getConfig(),\n                      baseURL: 'https://www.example.com'\n                    })\n                    console.log(complexAPI.getURL({id: '123'})) \n                    // https://www.example.com/update/123\n\n                    console.log(complexAPI.getURL({id: '123', author: 'Bob'})) \n                    // https://www.example.com/update/123?author=Bob\n                  "))},{heading:"Path and query parameters",anchor:"parameters",content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"The names and types of path and query parameters are accessible from the ",Object(p.d)(l.a,null,"apiUrlParameters")," ","property of the api."),Object(p.d)(i.c,null,"\n                    const {(params, query, optionalQuery, boolQuery)} = api.apiUrlParameters\n                  "),"The are tuples in nature, but can be treated as arrays of strings.")},{heading:"Types",anchor:"types",content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"This is where things get a little bit more interesting. You can't just export types from and object in typescript, but that's what an API is. Papupata uses a workaround for this problem which looks odd at first, but you get used to it quickly enough. That is, the api exports values that as far as typescript is concerned match the various types used by papupata, allowing the use of ",Object(p.d)(l.a,null,"typeof")," operator to access the actual type."))},{heading:"Response",anchor:"types_response",level:1,content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"Let's start with the type of the response."),Object(p.d)(i.c,null,"\n                    const ApiResponseType = typeof complexApi.ResponseType\n                  "),Object(p.d)("p",null,"In situations where the type of the response returned by the implementation is different from the one observed by the client, ",Object(p.d)(l.a,null,"ServerResponseType")," indicates the type the server is expected to return. If unspecified by the declaration, this is the same as ",Object(p.d)(l.a,null,"responseType.")),Object(p.d)(i.c,null,"\n                    type ApiResponseTypeOnClient = typeof complexApi.ResponseType\n                    type ApiResponseTypeOnServer = typeof complexApi.ServerResponseType\n                  "))},{heading:"Body",anchor:"types_body",level:1,content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"The body for the request follows the same pattern in the opposite direction, with ",Object(p.d)(l.a,null,"BodyType")," being the one observed by the server and ",Object(p.d)(l.a,null,"CallBodyType")," being the one used for API calls."),Object(p.d)(i.c,null,"\n                    type BodyTypeOnClient = typeof complexApi.CallBodyType\n                    type BodyTypeOnServer = typeof complexApi.BodyType\n                  "))},{heading:"Request",anchor:"types_requset",level:1,content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"The papupata request is an express request, possibly modified with your own fields as provided on the API declaration, but more importantly it has explicit types for params, query and body. You can access the request type for a specific API using its ",Object(p.d)(l.a,null,"RequestType")," property."),Object(p.d)(i.c,null,"\n                    type RequestType = typeof complexApi.RequestType\n                  "),Object(p.d)("p",null,"This can be especially useful when you want to use a named function as the implementation for an API."))},{heading:"Implementation",anchor:"implementation",content:Object(p.d)(a.Fragment,null,Object(p.d)("p",null,"You can get access to the current implementation and its middleware from the API. The primary use for this is for unit testing, but a clever individual can undoubtedly come up with other uses as well."),Object(p.d)(i.c,null,"\n                    const {implementation, implementationMiddleware} = complexApi\n                  "))}]}))))}},504:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return b}));n(505),n(1);var a=n(434),o=n(4),r=n(0);function s(){var e=c(['\n  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace\n']);return s=function(){return e},e}function l(){var e=c(["\n  font-size: 1.1em;\n"]);return l=function(){return e},e}function i(){var e=c([""]);return i=function(){return e},e}function c(e,t){return t||(t=e.slice(0)),e.raw=t,e}function p(e){var t=e.children;return Object(r.d)(a.j,null,Object(r.d)(a.k,null,"Overview"),t)}var u=o.a.h4(i()),d=o.a.h5(l());function h(e){var t=e.content;return Object(r.d)("div",null,Object(r.d)(a.j,null,Object(r.d)(a.k,null,"Table of contents"),Object(r.d)("ul",null,t.map((function(e){return Object(r.d)("li",{style:{marginLeft:18*(e.level||0)},key:e.anchor},Object(r.d)("a",{href:"#"+e.anchor},e.heading))})))),t.map((function(e){var t=e.level?d:u;return Object(r.d)(a.j,{id:e.anchor,key:e.anchor},Object(r.d)(t,null,e.heading),e.content)})))}var b=o.a.span(s())},505:function(e,t,n){"use strict";n(102)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))}}]);
//# sourceMappingURL=component---src-pages-guides-metadata-tsx-ec02d9e1e2b95e34e1c4.js.map