{"version":3,"sources":["webpack:///./src/pages/api/DeclaredAPI/implementBase.tsx","webpack:///./src/components/IncludeAvailableFromContext.tsx","webpack:///./src/pages/api/DeclaredAPI/implementWithExpressMiddleware.tsx","webpack:///./src/components/api-components.tsx","webpack:///./src/components/VersionVariants.tsx"],"names":["ImplementBase","availableFrom","variantPurpose","middlewareParameter","fnName","examples","version","name","dataType","isRecommendation","variants","label","IncludeAvailableFromContext","React","ImplementWithExpressMiddleware","Section","styled","section","SectionHeading","h4","SubHeading","h5","ExampleCommonContainer","Purpose","children","AvailableFrom","Usage","Parameters","includeAvailableFrom","Provider","value","Parameter","useContext","MethodReturnType","Caveats","Examples","Example","language","ExampleCommon","TypeParameters","Row","tr","NameColumn","td","DefaultValueColumn","DescriptionColumn","AvailableFromColumn","TypeParameter","defaultValue","Container","div","Note","VersionVariants","useState","selectedVersion","setSelectedVersion","updateSelectedVersion","useCallback","e","target","onChange","Object","keys","filter","variant","isApplicable","map","key"],"mappings":"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","file":"component---src-pages-api-declared-api-implement-with-express-middleware-tsx-48da218ef86ed0081aa0.js","sourcesContent":["import IndexLayout from '../../../layouts'\nimport Page from '../../../components/Page'\nimport Container from '../../../components/Container'\nimport {\n  Purpose,\n  Usage,\n  Parameter,\n  Parameters,\n  MethodReturnType,\n  Examples,\n  Example,\n  Caveats,\n  AvailableFrom\n} from '../../../components/api-components'\nimport React, { ReactNode } from 'react'\nimport VersionVariants from '../../../components/VersionVariants'\n\ninterface Params {\n  fnName: string\n  variantPurpose: ReactNode\n  middlewareParameter: ReactNode\n  examples: ReactNode\n  availableFrom?: '1.5.0'\n}\n\nexport default function ImplementBase({ availableFrom, variantPurpose, middlewareParameter, fnName, examples }: Params) {\n  return (\n    <IndexLayout>\n      <Page>\n        <Container>\n          <h1>API Reference</h1>\n          <h2>class DeclaredAPI</h2>\n          <h3>method {fnName}</h3>\n        </Container>\n        {availableFrom && <AvailableFrom version={availableFrom} />}\n        <Purpose>Implements an API using express. {variantPurpose}</Purpose>\n        <Usage>\n          Instead of calling the methods on an express app or router yourself, you use this function to have papupata do it for you.\n        </Usage>\n        <Parameters>\n          {middlewareParameter}\n          <Parameter name=\"implementation\" dataType=\"Function\">\n            A function that implements the route. Specified as follows\n            <Parameters>\n              <Parameter name=\"req\" dataType=\"Request\">\n                This is a typed express request -- that is, body, params and query have been replaced with typed versions of themselves.\n              </Parameter>\n              <Parameter name=\"res\" dataType=\"Response\">\n                Express response corresponding to the request.\n              </Parameter>\n            </Parameters>\n            <MethodReturnType>ResponseType, ServerResponseType, or a promise of either</MethodReturnType>\n            <ul>\n              <li>Do note that the \"next\" parameter typically used in routes is not present</li>\n              <li>Anything thrown (includes returned rejected promises) is given to the usual next function</li>\n              <li>\n                If undefined is returned, nothing is sent automatically. This could at times explain hanging requests. Of course, unless you\n                explicitly declared the API to return undefined, you should see type errors, too.\n              </li>\n            </ul>\n          </Parameter>\n        </Parameters>\n        <MethodReturnType>Nothing</MethodReturnType>\n        <Caveats>\n          <ul>\n            <li>Either application of router must be configured or the function throws</li>\n            <li>You can implement an API multiple times, but it is unlikely to do you any good.</li>\n            <li>\n              There is at this time no way to cleanly implement an API that does not just return its value, and instead, say, streams it.\n            </li>\n          </ul>\n        </Caveats>\n        <Examples>\n          <VersionVariants\n            isRecommendation\n            variants={{\n              '1.x': (\n                <Example label=\"Declaration\">\n                  {`\n                    import { APIDeclaration } from 'papupata'\n                    const api = new APIDeclaration()\n                    const myAPI = api.declarePostAPI('/do-stuff/:param')\n                      .params(['param'] as const)\n                      .query(['q'] as const)\n                      .body<{key: string}>()\n                      .response<string>()\n                  `}\n                </Example>\n              ),\n              '2.x': (\n                <Example label=\"Declaration\">\n                  {`\n                  import { APIDeclaration } from 'papupata'\n                  const api = new APIDeclaration()\n                  const myAPI = api.declarePostAPI('/do-stuff/:param')\n                    .params({param: String})\n                    .query({q: String})\n                    .body<{key: string}>()\n                    .response<string>()\n                `}\n                </Example>\n              )\n            }}\n          />\n\n          {examples}\n          <Example label=\"Usage in invocation\">\n            {`\n            const response = await myAPI({param: 'abc', q: 'def', key: 'ghi'})            \n            // Response in the example will be abc,def,ghi\n          `}\n          </Example>\n        </Examples>\n      </Page>\n    </IndexLayout>\n  )\n}\n","import * as React from 'react'\n\nexport const IncludeAvailableFromContext = React.createContext(false)\n","import ImplementBase from './implementBase'\nimport { Example, Parameter } from '../../../components/api-components'\n\nexport default function ImplementWithExpressMiddleware() {\n  return (\n    <ImplementBase\n      fnName=\"implementWithExpressMiddleware\"\n      variantPurpose={'This variant allows for inclusion of express middleware for the implementation.'}\n      middlewareParameter={\n        <Parameter name=\"middleware\" dataType=\"Function[]\">\n          An array of express middleware functions.\n        </Parameter>\n      }\n      availableFrom={'1.5.0'}\n      examples={\n        <Example label=\"Usage in implementation\">\n          {`\n            myAPI.implementWithExpressMiddleware(\n              [(req, res, next) => { console.log(req.url); next() }],\n              (req, res) => {\n              const {q} = req.query,\n                {param} = req.params,\n                {key} = req.body\n              res.set('x-my-header', 'Hello')\n              return [param, q, key].join()\n            })            \n          `}\n        </Example>\n      }\n    />\n  )\n}\n","import styled from 'styled-components'\nimport React, { ReactNode } from 'react'\nimport { Code } from './Code'\nimport { IncludeAvailableFromContext } from './IncludeAvailableFromContext'\n\nexport const Section = styled.section``\nexport const SectionHeading = styled.h4``\nexport const SubHeading = styled.h5``\nexport const ExampleCommonContainer = styled.section`\n  padding: 15px 30px;\n  background: lightyellow;\n`\n\nexport const Purpose: React.FC = ({ children }) => {\n  return (\n    <Section>\n      <SectionHeading>Purpose</SectionHeading>\n      {children}\n    </Section>\n  )\n}\n\nexport type ValidVersions = '1.1.0' | '1.2.0' | '1.5.0' | '1.8.0' | '2.0.0'\nexport const AvailableFrom = ({ version }: { version: ValidVersions }) => {\n  return (\n    <Section>\n      <SectionHeading>Availability</SectionHeading>\n      This functionality is available from papupata version {version} onwards.\n    </Section>\n  )\n}\n\nexport const Usage: React.FC = ({ children }) => {\n  return (\n    <Section>\n      <SectionHeading>Usage</SectionHeading>\n      {children}\n    </Section>\n  )\n}\nexport const Parameters: React.FC<{ includeAvailableFrom?: boolean; label?: string }> = ({ children, includeAvailableFrom, label }) => {\n  return (\n    <Section>\n      <IncludeAvailableFromContext.Provider value={!!includeAvailableFrom}>\n        <SectionHeading>Parameters{label && `: ${label}`}</SectionHeading>\n        {children ? (\n          <table>\n            <thead>\n              <tr>\n                <th>Name</th>\n                <th>Type</th>\n                <th>Description</th>\n                {includeAvailableFrom && <th>Introduced in</th>}\n              </tr>\n            </thead>\n            <tbody>{children}</tbody>\n          </table>\n        ) : (\n          <p>There are no parameters.</p>\n        )}\n      </IncludeAvailableFromContext.Provider>\n    </Section>\n  )\n}\n\nexport const Parameter: React.FC<{ name: string; dataType: any; availableFrom?: ValidVersions }> = ({\n  children,\n  name,\n  dataType,\n  availableFrom = '1.0.0'\n}) => {\n  const includeAvailableFrom = React.useContext(IncludeAvailableFromContext)\n  return (\n    <tr>\n      <td>{name}</td>\n      <td>{dataType}</td>\n      <td>{children}</td>\n      {includeAvailableFrom && <td>{availableFrom}</td>}\n    </tr>\n  )\n}\n\nexport const MethodReturnType: React.FC = ({ children }) => {\n  return (\n    <Section>\n      <SectionHeading>Returns</SectionHeading>\n      {children}\n    </Section>\n  )\n}\n\nexport const Caveats: React.FC = ({ children }) => {\n  return (\n    <Section>\n      <SectionHeading>Caveats</SectionHeading>\n      {children}\n    </Section>\n  )\n}\nexport const Examples: React.FC<{ children: any }> = ({ children }) => {\n  return (\n    <Section>\n      <SectionHeading>Examples</SectionHeading>\n      {children}\n    </Section>\n  )\n}\n\nexport const Example: React.FC<{ label?: string; children: string }> = ({ children, label }) => {\n  return (\n    <>\n      {label && <SubHeading>{label}</SubHeading>}\n      <Code language={'typescript'}>{children}</Code>\n    </>\n  )\n}\n\nexport const ExampleCommon: React.FC<{ children: any }> = ({ children }) => {\n  return (\n    <ExampleCommonContainer>\n      <SubHeading>Common to examples below:</SubHeading>\n      {children}\n    </ExampleCommonContainer>\n  )\n}\n\nexport const TypeParameters: React.FC<{ children: ReactNode; includeAvailableFrom?: boolean }> = ({ children, includeAvailableFrom }) => {\n  return (\n    <Section>\n      <SectionHeading>Type parameeters</SectionHeading>\n      <IncludeAvailableFromContext.Provider value={!!includeAvailableFrom}>\n        <SectionHeading>Parameters</SectionHeading>\n        {children ? (\n          <table>\n            <thead>\n              <tr>\n                <th>Name</th>\n                <th>Default value</th>\n                <th>Description</th>\n                {includeAvailableFrom ? <th>Introduced in</th> : ''}\n              </tr>\n            </thead>\n            <tbody>{children}</tbody>\n          </table>\n        ) : (\n          <p>There are no parameters.</p>\n        )}\n      </IncludeAvailableFromContext.Provider>\n    </Section>\n  )\n}\n\nconst Row = styled.tr``\nconst NameColumn = styled.td``\nconst DefaultValueColumn = styled.td``\nconst DescriptionColumn = styled.td``\nconst AvailableFromColumn = styled.td``\n\nexport const TypeParameter: React.FC<{ name: string; defaultValue?: string; availableFrom?: string }> = ({\n  children,\n  name,\n  defaultValue,\n  availableFrom = 'none'\n}) => {\n  const includeAvailableFrom = React.useContext(IncludeAvailableFromContext)\n  return (\n    <Row>\n      <NameColumn>{name}</NameColumn>\n      <DefaultValueColumn>{defaultValue}</DefaultValueColumn>\n      <DescriptionColumn>{children}</DescriptionColumn>\n      {includeAvailableFrom ? <AvailableFromColumn>{availableFrom}</AvailableFromColumn> : ''}\n    </Row>\n  )\n}\n","import React, { ReactNode, useCallback, useState } from 'react'\nimport styled from 'styled-components'\n\nexport type VariantVersion = '*' | SelectableVersion\ntype SelectableVersion = '1.x' | '2.x'\n\ninterface Props {\n  isRecommendation?: boolean\n  variants: {\n    [K in VariantVersion]?: ReactNode\n  }\n}\n\nconst Container = styled.div`\n  border-left: 4px solid #663399;\n  padding: 5px 0 5px 10px;\n`\n\nconst Note = styled.div`\n  display: inline-block;\n  margin-left: 10px;\n  font-size: 0.9em;\n`\n\nexport default function VersionVariants({ variants, isRecommendation }: Props) {\n  const [selectedVersion, setSelectedVersion] = useState<SelectableVersion>('2.x')\n  const updateSelectedVersion = useCallback((e: React.ChangeEvent<HTMLSelectElement>) => {\n    setSelectedVersion(e.target.value as any)\n  }, [])\n\n  return (\n    <Container>\n      <select value={selectedVersion} onChange={updateSelectedVersion}>\n        <option value=\"1.x\">Papupata 1.x</option>\n        <option value=\"2.x\">Papupata 2.x</option>\n      </select>\n      {isRecommendation && <Note>Older styles are still supported in later versions, just not preferred.</Note>}\n      {(Object.keys(variants) as VariantVersion[])\n        .filter((variant) => isApplicable(selectedVersion, variant))\n        .map((variant) => (\n          <div key={variant}>{variants[variant]}</div>\n        ))}\n    </Container>\n  )\n}\n\nfunction isApplicable(version: SelectableVersion, variant: VariantVersion) {\n  if (variant === '*') return true\n  return variant === version\n}\n"],"sourceRoot":""}